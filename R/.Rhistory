plot(ggcLassoFit)
source('ngc.r')
plot(ggcLassoFit)
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
plot(ggcLassoFit)
source('ngc.r')
plot(ggcLassoFit)
plot(ggcLassoFit2)
plot(ggcLassoFit)
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
plot(ggcLassoFit)
plot(ggcLassoFit2)
dim(edge)
edge
apply(abs(edge)>0, 1, sum)
ggcLassoFit2$group
d
group=rep(1:15,4)
group
ggcLassoFit2$group = group
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
group=rep(c(1,1,1,2,2,2,2,3,3,3,4,4,5,5,6),4)
ggcLassoFit2$group = group
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
plot(ggcLassoFit)
ggcLassoFit2$group = NULL
plot(ggcLassoFit)
plot(ggcLassoFit2)
plot(ggcLassoFit)
ggcLassoFit$dag
?add_edges
plot(ggcLassoFit)
add_edges(ggcLassoFit$dag, c(43, 50))
E(ggcLassoFit$dag)
E(ggcLassoFit$dag)$weight
ggcLassoFit$dag = add_edges(ggcLassoFit$dag, c(43, 50))
E(ggcLassoFit$dag)
E(ggcLassoFit$dag)$weight
E(ggcLassoFit$dag)$weight[4] = 0.1
plot(ggcLassoFit)
E(ggcLassoFit$dag)$weight[4] = 0.05
plot(ggcLassoFit)
source('ngc.r')
plot(ggcLassoFit)
source('ngc.r')
plot(ggcLassoFit)
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit)
source('ngc.r')
plot(ggcLassoFit2)
ggcLassoFit$dag
ggcLassoFit$dag[1]
ggcLassoFit$dag[,1]
E(ggcLassoFit$dag)
E(ggcLassoFit$dag)[1]
E(ggcLassoFit$dag)[1][1]
E(ggcLassoFit$dag)[[1]]
E(ggcLassoFit$dag)[[1]]$tail
E(ggcLassoFit$dag)[[]]
E(ggcLassoFit$dag)[[]][1,]
E(ggcLassoFit$dag)[[]][1]
E(ggcLassoFit$dag)[[]]
names(E(ggcLassoFit$dag)[[]])
E(ggcLassoFit$dag)[[]][[1]]
E(ggcLassoFit$dag)[[]][[,1]]
typeof(E(ggcLassoFit$dag))
typeof(E(ggcLassoFit$dag)[[]])
E(ggcLassoFit$dag)[[]]
names(ggcLassoFit$dag)
ggcLassoFit$dag
tail_of(ggcLassoFit$dag)
?tail_of
tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag))
tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag)) < 48
tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag)) < 42
plot(ggcLassoFit$dag)
plot(ggcLassoFit)
(tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag)) <= 40)*0.5
source('ngc.r')
plot(ggcLassoFit)
(tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag)) %/% 6)
(tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag)) %/% 8)
(tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag)))
(tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag)) % 8)
(tail_of(ggcLassoFit$dag, E(ggcLassoFit$dag)) %% 8)
g=ggcLassoFit$dag
edgeTails <- tail_of(g, E(g))
edgeTails
edgeCurvature <- (edgeTails <= p*(d-1))*0.5
edgeCurvature
p
edgeCurvature <- (edgeTails <= 40)*0.5
edgeCurvature
((head_of(g, E(g)) %% p) > (edgeTails %% p))
head_of(g, E(g)) %% p
((head_of(g, E(g)) %% 8) > (edgeTails %% 8))
E(g)
(-1)^((head_of(g, E(g)) %% 8) > (edgeTails %% 8))
source('ngc.r')
plot(ggcLassoFit)
source('ngc.r')
plot(ggcLassoFit)
source('ngc.r')
plot(ggcLassoFit)
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
source('ngc.r')
plot(ggcLassoFit2)
plot(ggcLassoFit)
E(g)$weight
ggcLassoFit <- ngc(X, d, typeIerr = typeIerr, method = 'regular')
plot(ggcLassoFit)
p <- 8
tp <- 20
d_actual <- 2
d <- 6
n <- 20
sigma <- 0.3
edge <- defn_net(d=d_actual, p=p, n = n)
X <- simulate_data(n, edge[1:d_actual,,], tp, error_sd = sigma)
typeIerr <- 0.05
c2 <- NULL
fit2
fit2 = ggcLassoFit
ggcLassoFit <- ngc(X, d, typeIerr = typeIerr, method = 'regular')
plot(ggcLassoFit)
apply(abs(edge)>0, 1, sum)
X <- simulate_data(n, edge[1:d_actual,,], tp, error_sd = sigma)
ggcLassoFit <- ngc(X, d, typeIerr = typeIerr, method = 'regular')
plot(ggcLassoFit)
edge <- defn_net(d=d_actual, p=p, n = n)
X <- simulate_data(n, edge[1:d_actual,,], tp, error_sd = sigma)
ggcLassoFit <- ngc(X, d, typeIerr = typeIerr, method = 'regular')
plot(ggcLassoFit)
fit = ggcLassoFIt
fit = ggcLassoFit
rm(ggcLassoFit)
rm(ggcLassoFit2)
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit)
plot(fit2)
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit2)
source('ngc.r')
plot(fit2)
plot(fit)
source('ngc.r')
plot(fit)
source('ngc.r')
plot(fit)
plot(fit2)
?text
source('ngc.r')
plot(fit)
plot(fit2)
plot(fit)
source('ngc.r')
plot(fit)
plot(fit2)
plot(fit2,ngc.type = "granger")
plot(fit)
len
dim(X)
scale(X[1,,])
sd(X[1,,1])
sd(X[1,,2])
sd(c(1,2,3))
sd(c(1,3,5))
plot(fit2)
plot(fit)
?legend
legend(-1, legend = 1:15)
legend(10, 10, legend = 1:15)
covnames=c('aaa','bbb','ccc','ddd','eee','fff','ggg','hhh')
paste(1:8, covnames)
paste(1:8, covnames, sep = " - ")
plot(fit)
legend(8, 8, paste(1:8, covnames, sep = " - "))
paste(1:8, covnames, sep = " - ")
legend(8, 8, paste(1:8, covnames, sep = " - "), title="Legend")
plot(fit)
legend(8, 8.5, paste(1:8, covnames, sep = " - "), title="Legend")
plot(fit)
legend(8, 8.5, paste(1:8, covnames, sep = " - "), title="Legend", border = "none")
plot(fit)
legend(8, 8.5, paste(1:8, covnames, sep = " - "), title="Legend", bty = "n")
legend(8, 8.5, paste(1:8, covnames, sep = " - "), title="Legend")
source('ngc.r')
plot(fit)
fit$covNames <- covnames
plot(fit)
source('ngc.r')
plot(fit)
plot(fit2)
fit2$covNames <- c(covnames, "i", "j", "k", "l", "m", "n", "ooooo")
plot(fit2)
source('ngc.r')
plot(fit2)
plot(fit)
plot(fit2)
(4/15)/2
plot(fit)
plot(fit2)
p
p%%10
p%/%10
12%/%10
12%/%10 + 1
source('ngc.r')
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit)
source('ngc.r')
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit)
source('ngc.r')
plot(fit)
source('ngc.r')
plot(fit)
plot(fit2)
plot(fit)
source('ngc.r')
plot(fit)
source('ngc.r')
plot(fit)
plot(fit2)
source('ngc.r')
plot(fit2)
source('ngc.r')
plot(fit2)
source('ngc.r')
plot(fit2)
plot(fit)
plot(fit2)
fit2$covNames <- c('AA', 'BB', 'CC', 'DD', 'EE', 'FF', 'GG', 'HH', 'II', 'JJ', 'KK', 'LL', 'MM', 'NN', 'OO')
plot(fit2)
fit2$covNames <- c('AAQQQQQ', 'BB', 'CC', 'DD', 'EE', 'FF', 'GG', 'HH', 'II', 'JJ', 'KK', 'LL', 'MM', 'NN', 'OO')
plot(fit2)
fit2$covNames <- c('AA', 'BB', 'CC', 'DD', 'EE', 'FF', 'GG', 'HH', 'II', 'JJ', 'KK', 'LL', 'MM', 'NN', 'OO')
plot(fit2)
source('ngc.r')
plot(fit2)
plot(fit)
plot(fit2)
plot(fit)
plot(fit2)
dim(X)
apply(X[,,19], 2, mean)
apply(X[,,19], 2, sd)
apply(X[,,19], 2, sd)*sqrt(20/19)
x
x/c(1,2,3)
rep(c(1,2),each=3)
matrix(rep(c(1,2),each=5),nrow=5,ncol=2)
x=matrix(c(1,0,0,0,1,0,0,0,1),nrow=3, ncol=3)
x
y
y=matrix(c(1,2,3,4,5,6),nrow=2)
y
apply(y,2,mean)
x/(apply(y,2,mean))
x=matrix(rep(1,9),nrow=3, ncol=3)
x/(apply(y,2,mean))
setwd("/Users/njetzel/Documents/RA/NGC/R")
source("defn.r")
source("simulate.r")
source("array2mat.r")
source("pldag.set.r")
source("ngc.r")
source("grangerLasso.r")
source("grangerTLasso.r")
source("grangerThrLasso.r")
fitnew <- ngc(X, d, typeIerr = typeIerr, method = 'regular')
plot(fit)
plot(fitnew)
fitnew$dag
plot(fit)
setwd("/Users/njetzel/Documents/RA/NGC/R")
source("defn.r")
source("simulate.r")
source("array2mat.r")
source("pldag.set.r")
source("ngc.r")
source("grangerLasso.r")
source("grangerTLasso.r")
source("grangerThrLasso.r")
setwd("/Users/njetzel/Documents/RA/NGC/R")
source("defn.r")
source("simulate.r")
source("array2mat.r")
source("pldag.set.r")
source("ngc.r")
source("grangerLasso.r")
source("grangerTLasso.r")
source("grangerThrLasso.r")
fitnew <- ngc(X, d, typeIerr = typeIerr, method = 'regular')
plot(fitnew)
plot(fit)
source('grangerLasso.r')
fitnew <- ngc(X, d, typeIerr = typeIerr, method = 'regular')
plot(fitnew)
predict(fitnew)
source('ngc.r')
predict(fitnew)
fitnew$tsOrder
source('ngc.r')
predict(fitnew)
source('ngc.r')
predict(fitnew)
source('ngc.r')
predict(fitnew)
fitnew <- ngc(X, d, method = 'regular')
fitnew$tsOrder
plot(fitnew)
predict(fitnew)
predict(fitnew,tp=3)
fitnew$dag
edgeIx
edgeIx=which(edge!=0, arr.ind=TRUE)
edgeIx
E(fitnew$dag)$weight
E(fitnew$dag)
predict(fitnew)
X[,,20]
predict(fitnew)-X[,,20]
x
as.vector(x)
plot(as.vector(predict(fitnew), as.vector(X[,,20])))
plot(as.vector(predict(fitnew)), as.vector(X[,,20]))
plot(fitnew)
plot(fit)
source('grangerLasso.r')
fitnew <- ngc(X, d, method = 'regular')
plot(fitnew)
E(fitnew$dag)
thrfit <- ngc(X, d, method = "threshold")
plot(thrfit)
plot(fitnew)
E(thrfit$dag)
E(thrfit$dag)$weight
E(fitnew$dag)$weight
tfit <- ngc(X, d, method = "truncate")
thrRefit <- ngc(X, d, method = "threshold", refit = T)
plot(thrfit)
plot(thrRefit)
plot(thrfit)
plot(thrRefit)
source('ngc.r')
thrRefit <- ngc(X, d, method = "threshold", refit = T)
plot(thrRefit)
plot(thrfit)
plot(thrRefit)
thrfit <- ngc(X, d, method = "threshold")
plot(thrfit)
plot(thrRefit)
E(thrfit)$weight
E(thrfit$dag)$weight
E(thrRefit$dag)$weight
thrfit <- ngc(X, d, method = "threshold")
source('ngc.r')
thrfit <- ngc(X, d, method = "threshold")
plot(thrRefit)
plot(thrfit)
tfit <- ngc(X, d, method = "truncate")
tfit <- ngc(X, d, method = "truncate", typeIerr = typeIerr)
plot(fit)
source('pldag.set.r')
fitdos=ngc(X,d,typeIerr = typeIerr)
plot(fitdos)
plot(fitnew)
plot(fit)
E(fitdos$dag)$weight
E(fit$dag)$weight
source('pldag.set.r')
fitdos=ngc(X,d,typeIerr = typeIerr)
E(fitdos$dag)$weight
source('pldag.set.r')
fitdos=ngc(X,d,typeIerr = typeIerr)
E(fitdos$dag)$weight
source('pldag.set.r')
fitdos=ngc(X,d,typeIerr = typeIerr)
E(fitdos$dag)$weight
plot(fitnew)
fitnew_s=ngc(X,d)
plot(fitnew_s)
source('grangerLasso.r')
fitnew_s=ngc(X,d)
plot(fitnew_s)
source('grangerLasso.r')
plot(fitnew)
fitnew2=ngc(X,d)
plot(fitnew2)
plot(fitnew_s)
plot(fitnew2)
plot(thrfit)
source("defn.r")
source("simulate.r")
source("array2mat.r")
source("pldag.set.r")
source("ngc.r")
source("grangerLasso.r")
source("grangerTLasso.r")
source("grangerThrLasso.r")
plot(fitnew_s)
plot(fitnew)
E(fitnew$dag)
fit1
fit1=ngc(X,d)
plot(fit1)
plot(fitnew)
plot(fit1)
plot(fitnew)
E(fit1$dag)
E(fitnew$dag)
E(fit1$dag)$weight
E(fitnew$dag)$weight
fit2=ngc(X,d)
plot(fit1)
plot(fit2)
plot(fitnew2)
plot(fit1)
plot(fitnew2)
E(fit1$dag)$weight
E(fitnew2$dag)$weight
plot(fit1)
plot(fit2)
rm(fit2)
plot(thrfit)
fit1=ngc(X,d,typeIerr = typeIerr)
E(fit1$dag)$weight
E(fit$dag)$weight
E(fitdos$dag)$weight
E(fit$dag)
E(fit1$dag)
E(fitdos$dag)
fit1=ngc(X,d,typeIerr = typeIerr,method="regular")
E(fit1$dag)$weight
plot(thrfit)
thrfit2=ngc(X,d,method='threshold')
plot(thrfit2)
source('grangerLasso.r')
source('pldag.set.r')
fit1=ngc(X,d,typeIerr=typeIerr)
E(fit1dag)$weight
E(fit1$dag)$weight
source('grangerLasso.r')
source('pldag.set.r')
fit1=ngc(X,d,typeIerr=typeIerr)
E(fit1$dag)$weight
source('pldag.set.r')
fit1=ngc(X,d,typeIerr=typeIerr)
E(fit1$dag)$weight
source('pldag.set.r')
fit1=ngc(X,d,typeIerr=typeIerr)
E(fit1$dag)$weight
source('grangerLasso.r')
fit1=ngc(X,d,typeIerr=typeIerr)
E(fit1$dag)$weight
source('pldag.set.r')
fit1=ngc(X,d,typeIerr=typeIerr)
E(fit1$dag)$weight
source('pldag.set.r')
fit1=ngc(X,d,typeIerr=typeIerr)
E(fit1$dag)$weight
plot(thrfit2)
plot(thrfit)
thrRefit2=ngc(X,d,method="threshold",refit=T)
plot(thrfit2)
plot(thrRefit2)
thrfit2=ngc(X,d,method='threshold')
plot(thrfit2)
thrRefit2=ngc(X,d,method="threshold",refit=T)
plot(thrRefit2)
